extends layout

block content
  h1= title
  p Все обращения

  // Кнопка для отмены всех обращений в статусе "В работе"
  form(method="POST", action="/cancel_all_in_progress")
    button(type="submit") Отменить все в работе

  // Форма для фильтрации
  form(method="GET", action="/all_appeal")
    div
      label(for="date") Конкретная дата:
      input(type="date", name="date", id="date", value=currentDate)

    div
      label(for="startDate") Начальная дата:
      input(type="date", name="startDate", id="startDate", value=currentStartDate)

    div
      label(for="endDate") Конечная дата:
      input(type="date", name="endDate", id="endDate", value=currentEndDate)

    div
      button(type="submit") Применить фильтры

  // Список обращений
  table
    thead
      tr
        th Тема
        th Текст
        th Статус
        th Решение
        th Дата создания
        th Действия
    tbody
      each appeal in appeals
        tr
          td= appeal.topic
          td
            a(href=`/appeal_detail/${appeal.id}`)= appeal.text
          td.status-cell(data-status=appeal.status)= appeal.status
          td= appeal.solution || '—'
          td= appeal.createdAt
          td
            if appeal.status === 'Завершено' || appeal.status === 'Отменено'
              button(type="button", disabled) Взять в работу
            else
              form(method="POST", action=`/appeal_solution/${appeal.id}/take_to_work`, style="display: inline;")
                button(type="submit") Взять в работу

  a(href="/create_appeal")
    button(type="button") Создать обращение